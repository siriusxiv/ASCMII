@****************************************************************************

Copyright (c) 2013, Boussejra Malik Olivier from the Ecole Centrale de Nantes
All rights reserved.
Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright
  notice, this list of conditions and the following disclaimer.
* Redistributions in binary form must reproduce the above copyright
  notice, this list of conditions and the following disclaimer in the
  documentation and/or other materials provided with the distribution.
* Neither the name of the copyright holder nor the names of its contributors
  may be used to endorse or promote products derived from this software
  without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE REGENTS AND CONTRIBUTORS BE LIABLE FOR ANY
DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

******************************************************************************@

@(serie_id:Long, seance_id: Long, typeQ: TypeQuestion, log: String)
@main("ASCMII - Création d'une nouvelle question - Etape 2/2"){

<!DOCTYPE html>

<html>
 <head>
  <title>ASCMII</title>
  <link rel="stylesheet" type="text/css" media="screen" href="@routes.Assets.at("stylesheets/gerer.css")">
 </head>
 <body class="yui-skin-sam" onLoad="editor()">
	<h1>ASCMII</h1>
	<form action="@routes.Application.logOut()" method="POST" class="logout">
		<button type="submit">Se déconnecter</button>
	</form>
	<p>Création d'une nouvelle question de type "@typeQ.typeQ"</p>
	<p class="log">@log</p>
	<form id="form" action="/prof/gerer/addq3/@serie_id/@typeQ.id" method="POST">
		<p>Titre de la question : <input type="text" name="titre"></p>
		<p>Entrez la question : </p>
		<textarea name="texte" id="editorQuestion" cols="50" rows="3"></textarea>
		@if(typeQ.id<=2){
			<p>Réponses :</p>
			<table>
			<tr id="reponse1">
				<td class="suppr"><a id="suppr1" onClick="removeReponse(1)">X</a></td>
				<td id="numero1"> 1.</td>
				<td><input type="text" id="texte1" name="reponse1" size="60px" value=""></td>
			</tr>
			<tr id="reponse2">
				<td class="suppr"><a id="suppr2" onClick="removeReponse(2)">X</a></td>
				<td id="numero2"> 2.</td>
				<td><input type="text" id="texte2" name="reponse2" size="60px" value=""></td>
			</tr>
			</table>
		}
		<div style="display:inline;padding:0px 0px 0px 200px"></form><button onClick="send()">Terminer</button></div>
	@if(typeQ.id<=2){
		<button onClick="addReponse()" style="position:relative; top:-25px;">Ajouter une autre réponse</button>
	}
	<form action="/prof/gerer/@seance_id" method="POST"><button type="submit">Retour</button></form>
	<p class="explications">Notez que les élèves ne verront pas le titre de la question. Vous pouvez donc mettre ce que vous voulez.<br>
							Vous pouvez intégrer des images (formules par exemple) par simple glisser-déplacer. Cependant, limitez la somme de la taille des images à quelque chose de l'ordre de 50 ko maximum. Préférez le format gif.<br>
							Après avoir cliqué sur "Terminer", vous pourrez assigner une image à chaque réponse sur la page de gestion de la séance.</p>
	
<script src="@routes.Assets.at("/javascripts/jquery-1.10.2.min.js")"></script>
<script>
	var nombreDeReponses = 2;
	
	function addReponse(){
		var reponseNumero='reponse'+(nombreDeReponses+1);
		var chaine1 = '<tr id="'+reponseNumero+'"><td class="suppr"><a id="suppr'+(nombreDeReponses+1)+'" onClick="removeReponse('+(nombreDeReponses+1)+')">X</a></td>';
		var chaine2 = '<td id="numero'+(nombreDeReponses+1)+'"> '+(nombreDeReponses+1)+'.</td>';
		var chaine3 = '<td><input type="text" id="texte'+(nombreDeReponses+1)+'" name="'+reponseNumero+'" size="60px" value=""></td></tr>';
		$('#reponse'+nombreDeReponses).after(chaine1+chaine2+chaine3);
		nombreDeReponses++;
	}
	function removeReponse(pos){
		if(nombreDeReponses<=2){
			alert('Vous devez au moins laisser deux réponses !');
		}else{
			$('#reponse'+pos).remove();
			pos++;
			while(pos<=nombreDeReponses){ //On doit changer tous les attributs dans les questions qui suivent celle qu'on supprime
				$('#reponse'+pos).attr('id','reponse'+(pos-1));
				$('#suppr'+pos).replaceWith('<a id="suppr'+(pos-1)+'" onClick="removeReponse('+(pos-1)+')">X</a>');
				$('#numero'+pos).replaceWith('<td id="numero'+(pos-1)+'"> '+(pos-1)+'.</td>');
				var value = $('#texte'+pos).val();
				$('#texte'+pos).replaceWith('<input type="text" id="texte'+(pos-1)+'" name="reponse'+(pos-1)+'" size="60px" value="'+value+'">');
				
				pos++;
			}
			nombreDeReponses--;
		}
	}
</script>
<!-- Rich text editor -->
<!-- Skin CSS file -->
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.9.0/build/assets/skins/sam/skin.css">
<!-- Utility Dependencies -->
<script src="http://yui.yahooapis.com/2.9.0/build/yahoo-dom-event/yahoo-dom-event.js"></script> 
<script src="http://yui.yahooapis.com/2.9.0/build/element/element-min.js"></script> 
<!-- Needed for Menus, Buttons and Overlays used in the Toolbar -->
<script src="http://yui.yahooapis.com/2.9.0/build/container/container_core-min.js"></script>
<!-- Source file for Rich Text Editor-->
<script src="http://yui.yahooapis.com/2.9.0/build/editor/simpleeditor-min.js"></script>
<script>
var editorQ;
function editor(){
editorQ = new YAHOO.widget.SimpleEditor('editorQuestion', {
    height: '150px',
    width: '522px',
    dompath: false, //Turns off the bar at the bottom
	toolbar: {
        buttons: [
            { group: 'textstyle', label: 'Font Style',
                buttons: [
                    { type: 'push', label: 'Bold', value: 'bold' },
                    { type: 'push', label: 'Italic', value: 'italic' },
                    { type: 'push', label: 'Underline', value: 'underline' },
                    { type: 'separator' },
                    { type: 'select', label: 'Arial', value: 'fontname', disabled: true,
                        menu: [
                            { text: 'Arial', checked: true },
                            { text: 'Arial Black' },
                            { text: 'Comic Sans MS' },
                            { text: 'Courier New' },
                            { text: 'Lucida Console' },
                            { text: 'Tahoma' },
                            { text: 'Times New Roman' },
                            { text: 'Trebuchet MS' },
                            { text: 'Verdana' }
                        ]
                    },
                    { type: 'spin', label: '13', value: 'fontsize', range: [ 9, 75 ], disabled: true },
                    { type: 'separator' },
                    { type: 'color', label: 'Font Color', value: 'forecolor', disabled: true }
                ]
            }
        ]
    }
});
editorQ.render();
}
function send(){
	editorQ.saveHTML();
	$('#form').submit();
}
</script>

}
</body>
</html>
